<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mini market</title>
    <link rel="stylesheet" href="css/main.css">
</head>

<body>
    <h1>Mini market</h1>
    <p>We have grocery, food, clothes, even flowers!</p>
    <p>You accept all kinds of payment: cash, credit card, debit card, paypal.</p>
    <p>Keep an eye on our online store! You get quality and save money at the same time!</p>

    <script>

        const categObjects = [
            { 
                description: "Clothes ~ unisex clothing", 
                imageURI: "https://emojipedia-us.s3.dualstack.us-west-1.amazonaws.com/thumbs/120/samsung/265/jeans_1f456.png",
                discount: false,
                outOfStock: true,
                category: "clothes",
                price: "10",
                discountPerc: "33",
            },
            { 
                description: "Food ~ fresh and delicious", 
                imageURI:  "https://emojipedia-us.s3.dualstack.us-west-1.amazonaws.com/thumbs/120/samsung/265/egg_1f95a.png",
                discount: false,
                outOfStock: false,
                category: "food",
                price: "5",
                discountPerc: "0",
            },
            { 
                description: "Flowers ~ for all occasions", 
                imageURI:  "https://emojipedia-us.s3.dualstack.us-west-1.amazonaws.com/thumbs/120/samsung/265/bouquet_1f490.png",
                discount: true,
                outOfStock: false,
                category: "none",
                price: "3",
                discountPerc: "25",

            },
            { 
                description: "Cooked food ~ for lunch and supper", 
                imageURI: "https://emojipedia-us.s3.dualstack.us-west-1.amazonaws.com/thumbs/120/samsung/265/spaghetti_1f35d.png" ,
                discount: false,
                outOfStock: false,
                category: "food",
                price: "15",
                discountPerc: "0",
            },
            { 
                description: "Fruits", 
                imageURI: "https://emojipedia-us.s3.dualstack.us-west-1.amazonaws.com/thumbs/120/samsung/265/lemon_1f34b.png" ,
                discount: false,
                outOfStock: false,
                category: "food",
                price: "0.5",
                discountPerc: "0",
            },
            { 
                description: "Clothes ~ for women only.", 
                imageURI: "https://emojipedia-us.s3.dualstack.us-west-1.amazonaws.com/thumbs/120/samsung/265/womans-clothes_1f45a.png" ,
                discount: true,
                outOfStock: false,
                category: "clothes",
                price: "7",
                discountPerc: "33",
            },
            { 
                description: "Vegetables", 
                imageURI: "https://emojipedia-us.s3.dualstack.us-west-1.amazonaws.com/thumbs/120/samsung/265/eggplant_1f346.png" ,
                discount: false,
                outOfStock: true,
                category: "food",
                price: "0.3",
                discountPerc: "0",
            },
            { 
                description: "Sandwiches and toasts", 
                imageURI: "https://emojipedia-us.s3.dualstack.us-west-1.amazonaws.com/thumbs/120/samsung/265/sandwich_1f96a.png" ,
                discount: true,
                outOfStock: false,
                category: "food",
                price: "2",
                discountPerc: "50",
            },
            { 
                description: "Bread and cookies", 
                imageURI: "https://emojipedia-us.s3.dualstack.us-west-1.amazonaws.com/thumbs/120/samsung/265/bread_1f35e.png" ,
                discount: false,
                outOfStock: false,
                category: "food",
                price: "3",
                discountPerc: "0",
            },
        ]


        function calcFinalPrice(category) {
            category.price = parseInt(category.price) - (parseInt(category.price) * (parseInt(category.discountPerc) / 100))
        }
        
        function createStoreFront() {

            categObjects.forEach(calcFinalPrice)

            // displaying the finalised array
            const parentElement = document.getElementById("storeFront")
            parentElement.innerHTML = ""
            for (let idx in categObjects) {
                const myDiv = document.createElement("div")
                myDiv.className = "store-item"
                parentElement.appendChild(myDiv)

                const priceDiv = document.createElement("p")
                priceDiv.innerHTML = categObjects[idx].price
                parentElement.appendChild(priceDiv)

                const myImg = document.createElement("img")
                myImg.src = categObjects[idx].imageURI
                if (categObjects[idx].category === "food") {
                    myImg.className = "food"
                }
                if (categObjects[idx].category === "clothes") {
                    myImg.className = "clothes"
                }
                if (categObjects[idx].category === "none") {
                    myImg.className = ""
                }
                if (categObjects[idx].discount) {
                    myImg.classList.add("discount")
                }
                if (categObjects[idx].outOfStock) {
                    myImg.classList.add("out-of-stock")
                }

                myDiv.appendChild(myImg)
                const myP = document.createElement("p")
                myP.innerHTML = categObjects[idx].description
                myDiv.appendChild(myP)
            }
        }

        function sortOnDescription() {
            console.log("Sorting on description")
            categObjects.sort(function comparator(a, b) {
                return (a.description === b.description) ? 0 : (a.description > b.description) ? 1 : -1
            })
            createStoreFront()
        }
        
        function sortOnDescriptionDesc() {
            console.log("Sorting on description desc")
            sortOnDescription()
            categObjects.reverse()
            createStoreFront()
        }
        
        function discountedFirst() {
            console.log("Sorting on discount")
            categObjects.sort(function comparator(a, b) {
                if (a.discount === b.discount) return 0
                if (a.discount < b.discount) return 1
                if (a.discount > b.discount) return -1
            })
            console.log(categObjects)
            createStoreFront()
        }

        console.log(categObjects)

    </script>

    <div class="buttons">
        <input type="button" value="bargains first!" onclick="discountedFirst()">
        <input type="button" value="description (asc)" onclick="sortOnDescription()">
        <input type="button" value="description (desc)" onclick="sortOnDescriptionDesc()">
    </div>
    <div class="store-front" id="storeFront" name="storeFront">
    </div>

    <div class="payment-methods">
        <div class="payment-method">
            <p>Credit card</p>
            <img
                src="https://emojipedia-us.s3.dualstack.us-west-1.amazonaws.com/thumbs/120/samsung/265/credit-card_1f4b3.png">
        </div>
        <div class="payment-method">
            <p>Cash</p>
            <img
                src="https://emojipedia-us.s3.dualstack.us-west-1.amazonaws.com/thumbs/120/samsung/265/euro-banknote_1f4b6.png">
        </div>
        <div class="payment-method-big">
            <p>Bitcoin</p>
            <img src="https://freesvg.org/img/bitcoin-0.png">
        </div>
        <div class="payment-method">
            <p>Paypal</p>
            <img src="https://www.paypalobjects.com/webstatic/icon/pp258.png">
        </div>
    </div>
</body>
<script>
    createStoreFront()
</script>

</html>